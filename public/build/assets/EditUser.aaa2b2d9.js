import{f as E,C as y,h as v,g as m,D as L,E as T,A as q,r as p,o as u,c as A,w as s,d as g,a as e,u as l,e as _,k as U,t as F,F as x,b as C}from"./app.40bb12c6.js";const N=E("editUser",{state:()=>({id:"",roles:["admin","despatch_manager","despatch_clerk","despatch_view","marketing_edit","marketing_view","sales_enquiries"],departments:["DH","sales","dev team","marketing"],available_status:["All","Active","Inactive"],userForm:{user_name:"",role:"",email_id:"",name:"",department_name:"",profile_status:""}}),actions:{async updateUserDetails(c){this.controller&&this.controller.abort(),this.controller=new AbortController;const t=this.controller.signal,n=y.exports.useLoading().show({color:"#5D2296",loader:"dots"});await v.post("/api/update-user",{userForm:this.userForm,userId:c},{signal:t}).then(i=>{i.data!=""?(setTimeout(()=>{n.hide()},100),m.fire({title:"Updated sucessfully!",icon:"success"})):(setTimeout(()=>{n.hide()},100),m.fire({title:"Record not saved",text:"Error in Database",icon:"warning"}))}).catch(function(i){setTimeout(()=>{n.hide()},100),i.name==="AbortError"&&console.log("Request canceled",i.name)})},deleteUser(c){m.fire({title:"Delete this record?",showDenyButton:!0,confirmButtonText:"Yes",denyButtonText:"No",text:"Are you sure? Once deleted you won't be able to recover this!",icon:"warning"}).then(t=>{if(t.isConfirmed){this.controller&&this.controller.abort(),this.controller=new AbortController;const f=this.controller.signal,i=y.exports.useLoading().show({color:"#5D2296",loader:"dots"});v.post("/api/delete-user",{userId:c},{signal:f}).then(w=>{console.log(typeof w.data),w.data!=""?(setTimeout(()=>{i.hide()},100),m.fire({title:"User record deleted sucessfully!",icon:"success"}).then(r=>{r.isConfirmed&&L.push({name:"users"})})):(setTimeout(()=>{i.hide()},100),m.fire({title:"Record not deleted",text:"Error in Database",icon:"warning"}))})}else setTimeout(()=>{loader.hide()},100),m.fire("Your user record is safe!")}).catch(function(t){setTimeout(()=>{loader.hide()},100),t.name==="AbortError"&&console.log("Request canceled",t.name)})},async EditUser(c){const f=y.exports.useLoading().show({color:"#5D2296",loader:"dots"});await v.post("/api/edit-user",{userId:c}).then(({data:n})=>{setTimeout(()=>{f.hide()},100),this.userForm=n})}}}),B=g("br",null,null,-1),$=g("span",{class:"arrow_styles material-icons"},"arrow_back",-1),J=g("h1",{class:"text-center"}," User Profile Update",-1),R=g("hr",null,null,-1),I=["value"],S=["value"],O=["value"],K=C("Delete "),j={__name:"EditUser",setup(c){const t=N();let n=T().query.id;const i=()=>{t.updateUserDetails(n)};return q(()=>{t.EditUser(n)}),(w,r)=>{const V=p("router-link"),a=p("b-col"),b=p("b-row"),d=p("FormKit"),k=p("b-form-row"),D=p("b-container");return u(),A(D,{fluid:"",class:"screenLayoutsWidth2"},{default:s(()=>[g("div",null,[B,e(b,{style:{"margin-top":"55px"}},{default:s(()=>[e(a,{cols:"4"},{default:s(()=>[e(V,{to:"/users",class:"btn btn-primary"},{default:s(()=>[$]),_:1})]),_:1}),e(a,{cols:"3",class:"headingAdjust"},{default:s(()=>[J]),_:1}),e(a,{cols:"5"})]),_:1})]),R,e(k,{class:"editUserForm"},{default:s(()=>[e(d,{type:"form",onSubmit:i},{default:s(()=>[e(b,null,{default:s(()=>[e(a,{cols:"2"}),e(a,{cols:"4"},{default:s(()=>[e(d,{type:"text",name:"user-id",label:"User Name",help:"Logging username(Ex:JoeL)",validation:[["required"],["length:0,25"]],placeholder:"JoeL",modelValue:l(t).userForm.user_name,"onUpdate:modelValue":r[0]||(r[0]=o=>l(t).userForm.user_name=o)},null,8,["modelValue"])]),_:1}),e(a,{cols:"4"},{default:s(()=>[e(d,{type:"text",name:"name",label:"Name",validation:"required|length:1,20",placeholder:"Joe Lewis",help:"FullName(Ex: Joe Lewis)",modelValue:l(t).userForm.name,"onUpdate:modelValue":r[1]||(r[1]=o=>l(t).userForm.name=o)},null,8,["modelValue"])]),_:1}),e(a,{cols:"2"})]),_:1}),e(b,null,{default:s(()=>[e(a,{cols:"2"}),e(a,{cols:"4"},{default:s(()=>[e(d,{type:"select",name:"role",label:"Role",help:"Console acess role",validation:"required",modelValue:l(t).userForm.role,"onUpdate:modelValue":r[2]||(r[2]=o=>l(t).userForm.role=o)},{default:s(()=>[(u(!0),_(x,null,U(l(t).roles,(o,h)=>(u(),_("option",{id:"searchDropdown",key:h,value:o},F(o),9,I))),128))]),_:1},8,["modelValue"])]),_:1}),e(a,{cols:"4"},{default:s(()=>[e(d,{type:"text",name:"email-id",label:"Email Id",help:"Offical email id(Ex:JoeLewis@dunsterhouse.co.uk)",validation:"required|ends_with:@dunsterhouse.co.uk",placeholder:"JoeLewis@dunsterhouse.co.uk",modelValue:l(t).userForm.email_id,"onUpdate:modelValue":r[3]||(r[3]=o=>l(t).userForm.email_id=o)},null,8,["modelValue"])]),_:1}),e(a,{cols:"2"})]),_:1}),e(b,null,{default:s(()=>[e(a,{cols:"2"}),e(a,{cols:"4"},{default:s(()=>[e(d,{type:"select",name:"department-name",label:"Department Name",help:"User from which department?",validation:"required",modelValue:l(t).userForm.department_name,"onUpdate:modelValue":r[4]||(r[4]=o=>l(t).userForm.department_name=o)},{default:s(()=>[(u(!0),_(x,null,U(l(t).departments,(o,h)=>(u(),_("option",{id:"searchDropdown",key:h,value:o},F(o),9,S))),128))]),_:1},8,["modelValue"])]),_:1}),e(a,{cols:"4"},{default:s(()=>[e(d,{type:"select",name:"status",label:"Status",validation:"required",help:"Only active users can access the site",modelValue:l(t).userForm.profile_status,"onUpdate:modelValue":r[5]||(r[5]=o=>l(t).userForm.profile_status=o)},{default:s(()=>[(u(!0),_(x,null,U(l(t).available_status,(o,h)=>(u(),_("option",{id:"searchDropdown",key:h,value:o},F(o),9,O))),128))]),_:1},8,["modelValue"])]),_:1}),e(a,{cols:"2"})]),_:1})]),_:1}),e(d,{type:"button",onClick:r[6]||(r[6]=o=>l(t).deleteUser(l(n)))},{default:s(()=>[K]),_:1})]),_:1})]),_:1})}}};export{j as default};
