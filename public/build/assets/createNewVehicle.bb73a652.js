import{f as D,h as g,V as k,C as N,g as v,D as A,r as d,o as h,c as C,w as o,d as u,a as i,u as a,e as p,k as V,t as f,F as y}from"./app.40bb12c6.js";const S=D("createNewVehicle",{state:()=>({helpText:["Van number should have a prefix of VAN","Ex: if the shipping agent service code is VAN123RUN1,","the Van number must be VAN123"].join(`
`),vehicleForm:{van_number:"",start_date:"",end_date:"",branch_id:"",shipping_agent_service_code:"",delivery_capacity:"",target_amount:"",registration_number:"",vehicle_type:"",vehicle_status:""},branches:[],branches_fix:!0,branches_data:[],vehiclestatus:[{index:0,name:"Not Active"},{index:1,name:"Active"},{index:2,name:"Inservice"},{index:3,name:"Accident or Repair"}],checkDuplicate:"new"}),actions:{async checkDublicateVan(n){console.log(n),await g.post("/api/check-van-validation",{vanNo:n}).then(e=>{console.log(e.data.result),e.data.result=="new"?this.checkDuplicate="":this.checkDuplicate="exist",console.log(this.checkDuplicate)})},setBranches(){this.branches_fix=!1,this.branches=[],this.branches_data=k.getCookie("branch_list"),this.branches_data=JSON.parse(this.branches_data),this.branches_data.forEach((n,e,c)=>{this.branches.push({branch_id:n.branch_id,branch_location:n.branch_location}),this.branches[0]!=""})},async createVehicleRecord(){this.controller&&this.controller.abort(),this.controller=new AbortController,this.controller.signal;const e=N.exports.useLoading().show({color:"#5D2296",loader:"dots"});await g.post("/api/create-vehicle",{vehicleForm:this.vehicleForm}).then(c=>{c.data!=""&&(c.statusText=="OK"&&(setTimeout(()=>{e.hide()},100),this.vehicleForm.van_number="",this.vehicleForm.start_date="",this.vehicleForm.end_date="",this.vehicleForm.branch_id="",this.vehicleForm.shipping_agent_service_code="",this.vehicleForm.delivery_capacity="",this.vehicleForm.target_amount="",this.vehicleForm.registration_number="",this.vehicleForm.vehicle_type="",this.vehicleForm.vehicle_status=""),v.fire({title:"Created sucessfully!",icon:"success"}).then(_=>{_.isConfirmed&&A.push({name:"vehicle"})})),c.data.includes("Could not connect")&&(setTimeout(()=>{e.hide()},100),v.fire({title:"Record not saved",text:"Error in Database",icon:"warning"}))}).catch(function(c){c.name==="AbortError"&&console.log("Request canceled",c.name)})}},getters:{getbranches_fix(n){return n.branches_fix},getDublicateStatus(n){return n.checkDuplicate}}}),B=u("br",null,null,-1),R=u("span",{class:"arrow_styles material-icons"},"arrow_back",-1),U=u("h1",{class:"text-center"},"Add Vehicle",-1),T=u("hr",null,null,-1),q=["value"],E=["value"],$={__name:"createNewVehicle",setup(n){const e=S();e.getbranches_fix==!0&&e.setBranches();const c=()=>{e.getDublicateStatus==""?e.createVehicleRecord():v.fire({title:"Record not saved",text:"Duplicate Van Record",icon:"warning"})};return(_,l)=>{const F=d("router-link"),s=d("b-col"),b=d("b-row"),r=d("FormKit"),x=d("b-form-row"),w=d("b-container");return h(),C(w,{fluid:"",class:"screenLayoutsWidth"},{default:o(()=>[u("div",null,[B,i(b,{style:{"margin-top":"55px"}},{default:o(()=>[i(s,{cols:"4"},{default:o(()=>[i(F,{to:"/vehicle",class:"btn btn-primary"},{default:o(()=>[R]),_:1})]),_:1}),i(s,{cols:"3",class:"headingAdjust"},{default:o(()=>[U]),_:1}),i(s,{cols:"5"})]),_:1})]),T,i(x,{class:"createVehicleForm"},{default:o(()=>[i(r,{type:"form",onSubmit:c,onChange:l[10]||(l[10]=t=>a(e).checkDublicateVan(a(e).vehicleForm.shipping_agent_service_code))},{default:o(()=>[i(b,null,{default:o(()=>[i(s,{cols:"2"}),i(s,{cols:"4"},{default:o(()=>[i(r,{type:"text",name:"van-number",label:"Van Number",help:a(e).helpText,validation:"required|alphanumeric|length:5,10",placeholder:"VANXXX",modelValue:a(e).vehicleForm.van_number,"onUpdate:modelValue":l[0]||(l[0]=t=>a(e).vehicleForm.van_number=t)},null,8,["help","modelValue"]),i(r,{type:"date",name:"start-date",label:"Start Date",placeholder:"dd-mm-yyyy",modelValue:a(e).vehicleForm.start_date,"onUpdate:modelValue":l[1]||(l[1]=t=>a(e).vehicleForm.start_date=t),help:"Date when van came into service"},null,8,["modelValue"]),i(r,{type:"select",name:"branch-name",label:"Branch Name",validation:"required",placeholder:"Bedford",modelValue:a(e).vehicleForm.branch_id,"onUpdate:modelValue":l[2]||(l[2]=t=>a(e).vehicleForm.branch_id=t),help:"Which branch is this van has to serve"},{default:o(()=>[(h(!0),p(y,null,V(a(e).branches,(t,m)=>(h(),p("option",{id:"searchDropdown",key:m,value:t.branch_id},f(t.branch_location),9,q))),128))]),_:1},8,["modelValue"]),i(r,{type:"text",name:"target-amount",label:"Target Amount",placeholder:"10000.00",validation:"required|length:3,10",modelValue:a(e).vehicleForm.target_amount,"onUpdate:modelValue":l[3]||(l[3]=t=>a(e).vehicleForm.target_amount=t),help:"Daily target amount for delivery"},null,8,["modelValue"]),i(r,{name:"registration-number",label:"Registration Number",placeholder:"AB12 CDE",validation:"required|matches:/^[A-Z]{2}[0-9]{2}\\s[A-Z]{3}$/",modelValue:a(e).vehicleForm.registration_number,"onUpdate:modelValue":l[4]||(l[4]=t=>a(e).vehicleForm.registration_number=t),help:"Registration number of the vehicle. Remember to add space between"},null,8,["modelValue"])]),_:1}),i(s,{cols:"4"},{default:o(()=>[i(r,{type:"text",name:"shipping-agent-service-code",label:"Shipping Agent Service Code",placeholder:"VAN123",validation:"required|alphanumeric|length:5,12",modelValue:a(e).vehicleForm.shipping_agent_service_code,"onUpdate:modelValue":l[5]||(l[5]=t=>a(e).vehicleForm.shipping_agent_service_code=t),help:"Van Number-Nav vehicle code"},null,8,["modelValue"]),i(r,{type:"date",name:"end-date",label:"End Date",placeholder:"dd/mm/yyyy",modelValue:a(e).vehicleForm.end_date,"onUpdate:modelValue":l[6]||(l[6]=t=>a(e).vehicleForm.end_date=t),help:"Date when will van went out of service"},null,8,["modelValue"]),i(r,{type:"text",name:"vehicle-type",label:"Vehicle Type",placeholder:"7.5T Flat Bed",validation:"required|length:0,35",modelValue:a(e).vehicleForm.vehicle_type,"onUpdate:modelValue":l[7]||(l[7]=t=>a(e).vehicleForm.vehicle_type=t),help:"What type of vehicle is it (Ex:3.5T Flat Bed,18T Curtain Side)"},null,8,["modelValue"]),i(r,{type:"number",name:"delivery-capacity",label:"Delivery Capacity",placeholder:"1000",validation:"required|length:0,5",modelValue:a(e).vehicleForm.delivery_capacity,"onUpdate:modelValue":l[8]||(l[8]=t=>a(e).vehicleForm.delivery_capacity=t),help:"Delivery capacity in kg"},null,8,["modelValue"]),i(r,{type:"select",name:"vehicle-status",label:"Vehicle Status",validation:"required",modelValue:a(e).vehicleForm.vehicle_status,"onUpdate:modelValue":l[9]||(l[9]=t=>a(e).vehicleForm.vehicle_status=t)},{default:o(()=>[(h(!0),p(y,null,V(a(e).vehiclestatus,(t,m)=>(h(),p("option",{id:"searchDropdown",key:m,value:m},f(t.name),9,E))),128))]),_:1},8,["modelValue"])]),_:1}),i(s,{cols:"2"})]),_:1})]),_:1})]),_:1})]),_:1})}}};export{$ as default};
