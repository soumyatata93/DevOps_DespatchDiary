import{f as k,C as U,h as C,g as h,D as x,A as L,r as d,o as n,c as N,w as s,d as c,a as o,u as t,e as i,k as b,t as w,F as y,y as q}from"./app.40bb12c6.js";const D=k("createNewUser",{state:()=>({canCopy:!1,copyToClipboard:"",roles:["admin","despatch_manager","despatch_clerk","despatch_view","marketing_edit","marketing_view","sales_enquiries"],departments:["DH","sales","dev team","marketing"],available_status:["Active","Inactive"],userForm:{user_name:"",password:"dunsterhouse",role:"",email_id:"",name:"",department_name:"",profile_status:""}}),actions:{async createUserRecord(p){this.controller&&this.controller.abort(),this.controller=new AbortController;const e=this.controller.signal,_=U.exports.useLoading().show({color:"#5D2296",loader:"dots"});await C.post("/api/create-user",{userForm:p},{signal:e}).then(a=>{a.data.error==0?a.data.result!="no"&&(setTimeout(()=>{_.hide()},100),h.fire({title:"Created sucessfully!",icon:"success"}).then(v=>{x.push({name:"users"})})):(setTimeout(()=>{_.hide()},100),h.fire({title:"Record not saved",text:a.data.error,icon:"warning"}))}).catch(function(a){setTimeout(()=>{_.hide()},100),a.name==="AbortError"&&console.log("Request canceled",a.name)})},async copy(p){this.copyToClipboard="Username:"+p+`
Password:dunsterhouse
Role:`+this.userForm.role+`
EmailId:`+this.userForm.email_id+`
Name:`+this.userForm.name+`
Site URL:https://despatchdiary.co.uk:8080`,await navigator.clipboard.writeText(this.copyToClipboard),h.fire({title:"Copied",icon:"success",text:"User details copied to clipboard"})}}}),A=c("br",null,null,-1),E=c("span",{class:"arrow_styles material-icons"},"arrow_back",-1),J=c("h1",{class:"text-center"}," Add User",-1),R=c("hr",null,null,-1),T=["value"],S=["value"],B=["value"],$={__name:"CreateUser",setup(p){const e=D(),F=()=>{e.createUserRecord(e.userForm)};return L(()=>{e.canCopy=!!navigator.clipboard}),(_,a)=>{const v=d("router-link"),l=d("b-col"),f=d("b-row"),u=d("FormKit"),g=d("b-form-row"),V=d("b-container");return n(),N(V,{fluid:"",class:"screenLayoutsWidth2"},{default:s(()=>[c("div",null,[A,o(f,{style:{"margin-top":"55px"}},{default:s(()=>[o(l,{cols:"4"},{default:s(()=>[o(v,{to:"/users",class:"btn btn-primary"},{default:s(()=>[E]),_:1})]),_:1}),o(l,{cols:"3",class:"headingAdjust"},{default:s(()=>[J]),_:1}),o(l,{cols:"5"})]),_:1})]),R,o(g,{class:"createUserForm"},{default:s(()=>[o(u,{type:"form",onSubmit:F},{default:s(()=>[o(f,null,{default:s(()=>[o(l,{cols:"2"}),o(l,{cols:"4"},{default:s(()=>[o(u,{type:"text",name:"user-id",label:"User Name",help:"Login username (Eg: JoeL for Joe Lewis)",validation:[["required"],["length:0,25"]],placeholder:"JoeL",modelValue:t(e).userForm.user_name,"onUpdate:modelValue":a[0]||(a[0]=r=>t(e).userForm.user_name=r)},null,8,["modelValue"])]),_:1}),o(l,{cols:"4"},{default:s(()=>[o(u,{type:"text",name:"name",label:"Name",validation:"required|length:1,20",placeholder:"Joe Lewis",help:"FullName(Ex: Joe Lewis)",modelValue:t(e).userForm.name,"onUpdate:modelValue":a[1]||(a[1]=r=>t(e).userForm.name=r)},null,8,["modelValue"])]),_:1}),o(l,{cols:"2"})]),_:1}),o(f,null,{default:s(()=>[o(l,{cols:"2"}),o(l,{cols:"4"},{default:s(()=>[o(u,{type:"select",name:"role",label:"Role",help:"Console acess role",validation:"required",modelValue:t(e).userForm.role,"onUpdate:modelValue":a[2]||(a[2]=r=>t(e).userForm.role=r)},{default:s(()=>[(n(!0),i(y,null,b(t(e).roles,(r,m)=>(n(),i("option",{id:"searchDropdown",key:m,value:r},w(r),9,T))),128))]),_:1},8,["modelValue"])]),_:1}),o(l,{cols:"4"},{default:s(()=>[o(u,{type:"text",name:"email-id",label:"Email Id",help:"Offical email id(Ex:JoeLewis@dunsterhouse.co.uk)",validation:"required|ends_with:@dunsterhouse.co.uk",placeholder:"JoeLewis@dunsterhouse.co.uk",modelValue:t(e).userForm.email_id,"onUpdate:modelValue":a[3]||(a[3]=r=>t(e).userForm.email_id=r)},null,8,["modelValue"])]),_:1}),o(l,{cols:"2"})]),_:1}),o(f,null,{default:s(()=>[o(l,{cols:"2"}),o(l,{cols:"4"},{default:s(()=>[o(u,{type:"select",name:"department-name",label:"Department Name",help:"User from which department?",validation:"required",modelValue:t(e).userForm.department_name,"onUpdate:modelValue":a[4]||(a[4]=r=>t(e).userForm.department_name=r)},{default:s(()=>[(n(!0),i(y,null,b(t(e).departments,(r,m)=>(n(),i("option",{id:"searchDropdown",key:m,value:r},w(r),9,S))),128))]),_:1},8,["modelValue"])]),_:1}),o(l,{cols:"4"},{default:s(()=>[o(u,{type:"select",name:"status",label:"Status",validation:"required",modelValue:t(e).userForm.profile_status,"onUpdate:modelValue":a[5]||(a[5]=r=>t(e).userForm.profile_status=r),help:"Only active users can access the site"},{default:s(()=>[(n(!0),i(y,null,b(t(e).available_status,(r,m)=>(n(),i("option",{id:"searchDropdown",key:m,value:r},w(r),9,B))),128))]),_:1},8,["modelValue"])]),_:1}),o(l,{cols:"2"})]),_:1})]),_:1}),t(e).userForm.user_name!=""&&t(e).userForm.name!=""&&t(e).userForm.role!=""&&t(e).userForm.email_id!=""&&t(e).userForm.department_name!=""&&t(e).userForm.profile_status!=""?(n(),i("button",{key:0,class:"ProfileCopy",onClick:a[6]||(a[6]=r=>t(e).copy(t(e).userForm.user_name))},"Copy")):q("",!0)]),_:1})]),_:1})}}};export{$ as default};
